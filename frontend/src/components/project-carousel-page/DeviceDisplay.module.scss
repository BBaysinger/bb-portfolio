@use "@/styles/mixins" as *;
@use "@/styles/variables" as *;

.devicePresentation {
  height: 420px;
  position: relative;
  background-size: contain;
  background-repeat: no-repeat;
  box-sizing: border-box;
  pointer-events: none;
  will-change: filter;
  transition: filter 0.4s ease-in-out;
}

.backgroundWrapper {
  height: 414px;
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  background-size: contain;
  background-repeat: no-repeat;
  box-sizing: border-box;
  width: 100%;

  &.laptop {
    background-image: url("/images/project-carousel/laptop.webp");
    background-position: calc(50% + 2px) center;
    background-size: 693px 414px;
    width: 693px;
    transform: translateX(-50%) scale(0.98);
    transition: transform 0.4s ease-in-out;
    will-change: transform;
    img {
      position: absolute;
      top: 38px;
      left: 97px;
      height: 310px;
      width: 500px;
    }
  }

  &.phone {
    // New inner frame so bezel and screen rotate together
    .phoneFrame {
      position: absolute;
      top: 46px; // portrait baseline
      left: 465px;
      width: 220px;
      height: 409px;
      transition: transform 0.4s ease-in-out;
      transform: translateY(3%) rotate(1deg);
      // Rotate from a point near the bottom (but not fully bottom) for a more natural hinge effect
      // Using 50% 70% keeps horizontal center while shifting vertical pivot upward slightly from bottom edge
      transform-origin: 50% 70%;
      will-change: transform;

      &::before {
        content: "";
        position: absolute;
        inset: 0;
        background-image: url("/images/project-carousel/phone.webp");
        background-size: cover;
        background-repeat: no-repeat;
        pointer-events: none;
      }

      // Phone screen image within the frame
      .screen,
      img {
        position: absolute;
        top: 23px; // 69 (img) - 46 (frame)
        left: 28px; // 493 (img) - 465 (frame)
        height: 354px;
        width: 162px;
      }

      &.none {
        display: none;
      }

      // Portrait uses defaults above

      &.Landscape {
        // Rotate the entire frame; counter-rotate the screen to keep content upright
        transform: translateY(5px) rotate(90deg);
        // Preserve pivot for landscape orientation
        transform-origin: 50% 70%;
        top: 135px;
        left: 337px;

        .screen,
        img {
          transform: rotate(-90deg);
          height: 162px; // landscape dimensions
          width: 354px;
          top: 123px; // 258 - 135
          left: -61px; // 276 - 337
        }
      }
    }
  }
}

// Reduced motion overrides â€“ remove transitions/animations when user prefers reduced motion
:global(.reduce-motion) {
  .devicePresentation {
    transition: none !important;
  }
  .backgroundWrapper.laptop {
    transition: none !important;
  }
  .backgroundWrapper.phone {
    .phoneFrame,
    .phoneFrame::before,
    .phoneFrame .screen,
    .phoneFrame img {
      transition: none !important;
    }
  }
}

// Stabilized and tilt overrides with higher specificity
:global(.bbStabilizedSlide) {
  .backgroundWrapper.phone {
    .phoneFrame.Portrait {
      transform: translateY(3%) rotate(0deg) !important;
    }
    .phoneFrame.Landscape {
      transform: translateY(5px) rotate(90deg) !important;
    }
  }
}

:global(.bbTiltLeft) {
  .backgroundWrapper.phone {
    .phoneFrame.Portrait {
      transform: translateY(3%) rotate(2deg) !important;
    }
    .phoneFrame.Landscape {
      transform: translateY(5px) rotate(92deg) !important;
    }
  }
}

:global(.bbTiltRight) {
  .backgroundWrapper.phone {
    .phoneFrame.Portrait {
      transform: translateY(3%) rotate(-4deg) !important;
    }
    .phoneFrame.Landscape {
      transform: translateY(5px) rotate(87deg) !important;
    }
  }
}
